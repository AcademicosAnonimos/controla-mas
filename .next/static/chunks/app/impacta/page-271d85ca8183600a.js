(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[82],{3554:function(e,a,s){Promise.resolve().then(s.bind(s,9527))},9527:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ImpactaPage}});var r=s(7437),c=s(2265),t=s(5220),l=s(6264),n=s(5313);function ImpactaPage(){let[e,a]=(0,c.useState)([]),[s,i]=(0,c.useState)(!0),[d,o]=(0,c.useState)(""),[m,h]=(0,c.useState)("");(0,c.useEffect)(()=>{cargarImpactos()},[]);let cargarImpactos=async()=>{try{let e=localStorage.getItem("usuarioActual"),s=await fetch("/api/impacta?id_usuario=".concat(e)),r=await s.json();a(r)}catch(e){console.error("Error cargando impactos:",e)}finally{i(!1)}},formatCurrency=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),formatDate=e=>new Date(e).toLocaleDateString("es-AR"),getNombreMes=e=>new Date(2e3,e-1).toLocaleString("es-AR",{month:"long"}),x=e.filter(e=>{let a=!d||e.mes===parseInt(d),s=!m||e.año===parseInt(m);return a&&s}),j=Array.from(new Set(e.map(e=>e.año))).sort((e,a)=>a-e),p=Array.from(new Set(e.map(e=>e.mes))).sort((e,a)=>e-a),f=(()=>{let e={};return x.forEach(a=>{let s="".concat(a.mes,"/").concat(a.año);e[s]=(e[s]||0)+a.importe_a_pagar}),e})();return(0,r.jsxs)("div",{className:"d-flex",children:[(0,r.jsx)(l.Z,{}),(0,r.jsxs)("div",{className:"flex-grow-1",children:[(0,r.jsx)(t.Z,{}),(0,r.jsxs)("main",{className:"container-fluid py-4",children:[(0,r.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"h3 mb-0",children:"Impacto de Pagos"}),(0,r.jsx)("p",{className:"text-muted",children:"Pagos que impactan en meses diferentes al original"})]})}),(0,r.jsx)("div",{className:"card mb-4",children:(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"col-md-4",children:[(0,r.jsx)("label",{htmlFor:"filtroMes",className:"form-label",children:"Filtrar por Mes"}),(0,r.jsxs)("select",{id:"filtroMes",className:"form-select",value:d,onChange:e=>o(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Todos los meses"}),p.map(e=>(0,r.jsx)("option",{value:e,children:getNombreMes(e)},e))]})]}),(0,r.jsxs)("div",{className:"col-md-4",children:[(0,r.jsx)("label",{htmlFor:"filtroA\xf1o",className:"form-label",children:"Filtrar por A\xf1o"}),(0,r.jsxs)("select",{id:"filtroA\xf1o",className:"form-select",value:m,onChange:e=>h(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Todos los a\xf1os"}),j.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsx)("div",{className:"col-md-4 d-flex align-items-end",children:(0,r.jsxs)("button",{className:"btn btn-outline-secondary w-100",onClick:()=>{o(""),h("")},children:[(0,r.jsx)("i",{className:"fas fa-times me-2"}),"Limpiar Filtros"]})})]})})}),Object.keys(f).length>0&&(0,r.jsxs)("div",{className:"card mb-4",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[(0,r.jsx)("i",{className:"fas fa-chart-bar me-2"}),"Resumen por Mes de Impacto"]})}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsx)("div",{className:"row",children:Object.entries(f).map(e=>{let[a,s]=e,[c,t]=a.split("/");return(0,r.jsx)("div",{className:"col-md-3 col-sm-6 mb-3",children:(0,r.jsx)("div",{className:"card bg-light",children:(0,r.jsxs)("div",{className:"card-body text-center p-3",children:[(0,r.jsxs)("h6",{className:"card-title mb-1",children:[getNombreMes(parseInt(c))," ",t]}),(0,r.jsx)("p",{className:"card-text h5 text-danger mb-0",children:formatCurrency(s)}),(0,r.jsx)("small",{className:"text-muted",children:"Total impactado"})]})})},a)})})})]}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-body",children:s?(0,r.jsx)("div",{className:"text-center py-4",children:(0,r.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"table-responsive",children:(0,r.jsxs)("table",{className:"table table-hover",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Gasto"}),(0,r.jsx)("th",{children:"Medio de Pago"}),(0,r.jsx)("th",{children:"Fecha Pago Real"}),(0,r.jsx)("th",{children:"Mes/A\xf1o Impacto"}),(0,r.jsx)("th",{children:"Importe"}),(0,r.jsx)("th",{children:"Usuario"})]})}),(0,r.jsx)("tbody",{children:x.map((e,a)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:e.descripcion_gasto})})}),(0,r.jsx)("td",{children:(0,r.jsxs)("span",{className:"badge bg-info",children:[(0,r.jsx)("i",{className:"fas fa-credit-card me-1"}),e.medio_pago]})}),(0,r.jsx)("td",{children:formatDate(e.fecha_pago)}),(0,r.jsx)("td",{children:(0,r.jsxs)("span",{className:"badge bg-warning",children:[getNombreMes(e.mes)," ",e.año]})}),(0,r.jsx)("td",{className:"text-danger fw-bold",children:formatCurrency(e.importe_a_pagar)}),(0,r.jsx)("td",{children:e.usuario_nombre})]},"".concat(e.id_pago,"-").concat(e.id_medio_pago,"-").concat(e.mes,"-").concat(e.año,"-").concat(a)))})]})}),0===x.length&&(0,r.jsxs)("div",{className:"text-center py-5 text-muted",children:[(0,r.jsx)("i",{className:"fas fa-calendar-alt fa-3x mb-3"}),(0,r.jsx)("p",{children:0===e.length?"No hay pagos con impacto diferido registrados":"No hay resultados para los filtros aplicados"}),0===e.length&&(0,r.jsx)("small",{children:"Los pagos con tarjeta de cr\xe9dito aparecer\xe1n aqu\xed cuando tengan impacto en meses diferentes"})]})]})})})]}),(0,r.jsx)(n.Z,{})]})]})}}},function(e){e.O(0,[412,517,971,472,744],function(){return e(e.s=3554)}),_N_E=e.O()}]);