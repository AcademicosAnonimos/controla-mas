(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{6337:function(e,s,a){Promise.resolve().then(a.bind(a,971))},971:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return UsuariosPage}});var n=a(7437),i=a(2265),r=a(5220),l=a(6264);function UsuarioForm(e){let{usuario:s,onSuccess:a,onCancel:r}=e,[l,t]=(0,i.useState)({nombre:"",monto_disponible:0}),[o,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)({});(0,i.useEffect)(()=>{s&&t(s)},[s]);let validateForm=()=>{let e={};return l.nombre.trim()||(e.nombre="El nombre es requerido"),l.monto_disponible<0&&(e.monto_disponible="El monto no puede ser negativo"),m(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm()){c(!0);try{let e=s?"/api/usuarios/".concat(s.id_usuario):"/api/usuarios",n=s?"PUT":"POST",i=await fetch(e,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(i.ok)a(),alert(s?"Usuario actualizado correctamente":"Usuario creado correctamente");else{let e=await i.json();alert(e.error)}}catch(e){alert("Error al guardar usuario")}finally{c(!1)}}},handleChange=e=>{let{name:s,value:a}=e.target;t(e=>({...e,[s]:"monto_disponible"===s?parseFloat(a)||0:a}))};return(0,n.jsxs)("form",{onSubmit:handleSubmit,children:[(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,n.jsxs)("label",{htmlFor:"nombre",className:"form-label",children:["Nombre ",(0,n.jsx)("span",{className:"text-danger",children:"*"})]}),(0,n.jsx)("input",{type:"text",className:"form-control ".concat(d.nombre?"is-invalid":""),id:"nombre",name:"nombre",value:l.nombre,onChange:handleChange,required:!0}),d.nombre&&(0,n.jsx)("div",{className:"invalid-feedback",children:d.nombre})]}),(0,n.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,n.jsx)("label",{htmlFor:"monto_disponible",className:"form-label",children:"Monto Disponible"}),(0,n.jsx)("input",{type:"number",step:"0.01",className:"form-control ".concat(d.monto_disponible?"is-invalid":""),id:"monto_disponible",name:"monto_disponible",value:l.monto_disponible,onChange:handleChange,min:"0"}),d.monto_disponible&&(0,n.jsx)("div",{className:"invalid-feedback",children:d.monto_disponible})]})]}),(0,n.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:o,children:"Cancelar"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Guardando..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("i",{className:"fas fa-save me-2"}),s?"Actualizar":"Crear"," Usuario"]})})]})]})}var t=a(5313);function UsuariosPage(){let[e,s]=(0,i.useState)([]),[a,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),[m,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{cargarUsuarios()},[]);let cargarUsuarios=async()=>{try{let e=await fetch("/api/usuarios"),a=await e.json();s(a)}catch(e){console.error("Error cargando usuarios:",e)}finally{u(!1)}},handleEdit=e=>{d(e),o(!0)},handleDelete=async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas eliminar este usuario?"))try{let s=await fetch("/api/usuarios/".concat(e),{method:"DELETE"});if(s.ok)cargarUsuarios(),alert("Usuario eliminado correctamente");else{let e=await s.json();alert(e.error)}}catch(e){alert("Error al eliminar usuario")}};return(0,n.jsxs)("div",{className:"d-flex",children:[(0,n.jsx)(l.Z,{}),(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("main",{className:"container-fluid py-4",children:[(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"h3 mb-0",children:"Gesti\xf3n de Usuarios"}),(0,n.jsx)("p",{className:"text-muted",children:"Administra los usuarios del sistema"})]}),(0,n.jsxs)("button",{className:"btn btn-primary",onClick:()=>o(!0),children:[(0,n.jsx)("i",{className:"fas fa-plus me-2"}),"Nuevo Usuario"]})]}),(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("div",{className:"card-body",children:m?(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,n.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,n.jsx)("div",{className:"table-responsive",children:(0,n.jsxs)("table",{className:"table table-hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ID"}),(0,n.jsx)("th",{children:"Nombre"}),(0,n.jsx)("th",{children:"Monto Disponible"}),(0,n.jsx)("th",{children:"Acciones"})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.id_usuario}),(0,n.jsx)("td",{children:e.nombre}),(0,n.jsx)("td",{children:new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e.monto_disponible)}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"btn-group btn-group-sm",children:[(0,n.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>handleEdit(e),children:(0,n.jsx)("i",{className:"fas fa-edit"})}),(0,n.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>handleDelete(e.id_usuario),children:(0,n.jsx)("i",{className:"fas fa-trash"})})]})})]},e.id_usuario))})]})})})}),a&&(0,n.jsx)("div",{className:"modal fade show d-block",tabIndex:-1,children:(0,n.jsx)("div",{className:"modal-dialog modal-lg",children:(0,n.jsxs)("div",{className:"modal-content",children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h5",{className:"modal-title",children:c?"Editar Usuario":"Nuevo Usuario"}),(0,n.jsx)("button",{type:"button",className:"btn-close",onClick:()=>o(!1)})]}),(0,n.jsx)("div",{className:"modal-body",children:(0,n.jsx)(UsuarioForm,{usuario:c,onSuccess:()=>{o(!1),d(null),cargarUsuarios()},onCancel:()=>o(!1)})})]})})})]}),(0,n.jsx)(t.Z,{})]})]})}}},function(e){e.O(0,[412,517,971,472,744],function(){return e(e.s=6337)}),_N_E=e.O()}]);