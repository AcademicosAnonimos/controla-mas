(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4],{9240:function(a,e,t){Promise.resolve().then(t.bind(t,7344))},7344:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return CuotasPage}});var s=t(7437),c=t(2265),r=t(5220),n=t(6264),o=t(5313);function CuotasPage(){let[a,e]=(0,c.useState)([]),[t,i]=(0,c.useState)(!0);(0,c.useEffect)(()=>{cargarCuotas()},[]);let cargarCuotas=async()=>{try{let a=localStorage.getItem("usuarioActual"),t=await fetch("/api/cuotas?id_usuario=".concat(a)),s=await t.json();e(s)}catch(a){console.error("Error cargando cuotas:",a)}finally{i(!1)}},handlePagarCuota=async a=>{if(confirm("\xbfMarcar esta cuota como pagada?"))try{let e=await fetch("/api/cuotas",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_cuota:a,accion:"pagar"})});if(e.ok)cargarCuotas(),alert("Cuota marcada como pagada correctamente");else{let a=await e.json();alert(a.error)}}catch(a){alert("Error al procesar pago de cuota")}},formatCurrency=a=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(a),formatDate=a=>new Date(a).toLocaleDateString("es-AR"),getEstadoBadge=a=>({Pagada:"bg-success",Pendiente:"bg-warning",Vencida:"bg-danger"})[a]||"bg-secondary";return(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(n.Z,{}),(0,s.jsxs)("div",{className:"flex-grow-1",children:[(0,s.jsx)(r.Z,{}),(0,s.jsxs)("main",{className:"container-fluid py-4",children:[(0,s.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"h3 mb-0",children:"Gesti\xf3n de Cuotas"}),(0,s.jsx)("p",{className:"text-muted",children:"Administra las cuotas de tus gastos temporales"})]})}),(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"card-body",children:t?(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-hover",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Descripci\xf3n"}),(0,s.jsx)("th",{children:"Tipo"}),(0,s.jsx)("th",{children:"Cuota"}),(0,s.jsx)("th",{children:"Monto Cuota"}),(0,s.jsx)("th",{children:"Vencimiento"}),(0,s.jsx)("th",{children:"Estado"}),(0,s.jsx)("th",{children:"Acciones"})]})}),(0,s.jsx)("tbody",{children:a.map(a=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:a.descripcion_gasto}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge bg-info",children:a.tipo_gasto})}),(0,s.jsxs)("td",{children:[a.nro_cuota,"/",a.total_cuotas]}),(0,s.jsx)("td",{children:formatCurrency(a.monto_total/a.total_cuotas)}),(0,s.jsx)("td",{children:formatDate(a.fecha_vencimiento_cuota)}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge ".concat(getEstadoBadge(a.estado)),children:a.estado})}),(0,s.jsx)("td",{children:"Pendiente"===a.estado&&(0,s.jsxs)("button",{className:"btn btn-success btn-sm",onClick:()=>handlePagarCuota(a.id_cuota),children:[(0,s.jsx)("i",{className:"fas fa-check me-1"}),"Pagar"]})})]},a.id_cuota))})]})})})})]}),(0,s.jsx)(o.Z,{})]})]})}}},function(a){a.O(0,[412,517,971,472,744],function(){return a(a.s=9240)}),_N_E=a.O()}]);