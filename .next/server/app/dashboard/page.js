(()=>{var e={};e.id=702,e.ids=[702],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},1903:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>c.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>n});var r=s(7096),t=s(6132),i=s(7284),c=s.n(i),o=s(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(a,l);let n=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1618)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\dashboard\\page.tsx"],m="/dashboard/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},1929:(e,a,s)=>{Promise.resolve().then(s.bind(s,3154))},3154:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>Dashboard});var r=s(784),t=s(9885),i=s(7100),c=s(7394);function DashboardCards({data:e}){let[a,s]=(0,t.useState)(0);(0,t.useEffect)(()=>{if(e){let a=Number(e.saldo_actual)||0;s(a)}},[e]);let formatCurrency=e=>{let a=Number(e)||0;return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)},i=[{title:"SALDO ACTUAL",value:formatCurrency(a),icon:"fas fa-wallet",color:"primary",description:"Disponible para gastar",hasData:null!==e},{title:"INGRESOS DEL MES",value:formatCurrency(e?.ingresos_mes||0),icon:"fas fa-arrow-down",color:"success",description:"Total de ingresos",hasData:null!==e&&Number(e?.ingresos_mes)>0},{title:"GASTOS DEL MES",value:formatCurrency(e?.gastos_mes||0),icon:"fas fa-arrow-up",color:"danger",description:"Total de gastos",hasData:null!==e&&Number(e?.gastos_mes)>0},{title:"PR\xd3XIMAS CUOTAS",value:e?.proximas_cuotas?.length>0?(e=>{let a=Number(e)||0;return a.toLocaleString("es-AR")})(e.proximas_cuotas.length):"0",icon:"fas fa-calendar",color:"warning",description:"Pendientes de pago",hasData:null!==e&&e?.proximas_cuotas?.length>0}];return e?r.jsx("div",{className:"row",children:i.map((e,a)=>r.jsx("div",{className:"col-xl-3 col-md-6 mb-4",children:r.jsx("div",{className:`card border-left-${e.color} shadow h-100 py-2 card-hover`,children:r.jsx("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row no-gutters align-items-center",children:[(0,r.jsxs)("div",{className:"col mr-2",children:[r.jsx("div",{className:`text-xs font-weight-bold text-${e.color} text-uppercase mb-1`,children:e.title}),r.jsx("div",{className:`h5 mb-0 font-weight-bold ${e.hasData?"text-gray-800":"text-muted"}`,children:e.value}),(0,r.jsxs)("div",{className:"text-xs text-muted mt-1",children:[e.description,!e.hasData&&"SALDO ACTUAL"!==e.title&&(0,r.jsxs)("span",{className:"text-warning ms-1",children:[r.jsx("i",{className:"fas fa-exclamation-circle me-1"}),"Sin datos"]})]})]}),r.jsx("div",{className:"col-auto",children:r.jsx("i",{className:`${e.icon} fa-2x text-${e.color} ${e.hasData?"":"opacity-50"}`})})]})})})},a))}):r.jsx("div",{className:"row",children:i.map((e,a)=>r.jsx("div",{className:"col-xl-3 col-md-6 mb-4",children:r.jsx("div",{className:"card border-left-secondary shadow h-100 py-2",children:r.jsx("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row no-gutters align-items-center",children:[(0,r.jsxs)("div",{className:"col mr-2",children:[r.jsx("div",{className:"text-xs font-weight-bold text-secondary text-uppercase mb-1",children:"Cargando..."}),r.jsx("div",{className:"h5 mb-0 font-weight-bold text-gray-800",children:r.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}),r.jsx("div",{className:"text-xs text-muted mt-1",children:"\xa0"})]}),r.jsx("div",{className:"col-auto",children:r.jsx("i",{className:"fas fa-spinner fa-2x text-secondary"})})]})})})},a))})}var o=s(3223),l=s(622);function CategoryChart({data:e}){let a={labels:e.map(e=>e.categoria),datasets:[{data:e.map(e=>e.total),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#FF6384","#C9CBCF"],borderWidth:2,borderColor:"#fff"}]};return r.jsx("div",{style:{height:"300px"},children:e.length>0?r.jsx(o.$I,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}):(0,r.jsxs)("div",{className:"text-center text-muted py-5",children:[r.jsx("i",{className:"fas fa-chart-pie fa-3x mb-3"}),r.jsx("p",{children:"No hay datos para mostrar"})]})})}function PredictionChart({data:e}){let a={labels:e.map(e=>e.categoria),datasets:[{label:"Monto Predicho",data:e.map(e=>e.monto_predicho),backgroundColor:"rgba(52, 152, 219, 0.6)",borderColor:"rgba(52, 152, 219, 1)",borderWidth:1}]};return r.jsx("div",{style:{height:"300px"},children:e.length>0?r.jsx(o.$Q,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Predicci\xf3n para el pr\xf3ximo mes"}},scales:{y:{beginAtZero:!0,ticks:{callback:function(e){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e)}}}}}}):(0,r.jsxs)("div",{className:"text-center text-muted py-5",children:[r.jsx("i",{className:"fas fa-chart-line fa-3x mb-3"}),r.jsx("p",{children:"No hay datos de predicci\xf3n disponibles"})]})})}l.kL.register(l.qi,l.u,l.De),l.kL.register(l.uw,l.f$,l.ZL,l.Dx,l.u,l.De);var n=s(4911);function Dashboard(){let[e,a]=(0,t.useState)(null),[s,o]=(0,t.useState)(!0);(0,t.useEffect)(()=>{cargarDashboard()},[]);let cargarDashboard=async()=>{try{o(!0);let e=localStorage.getItem("usuarioActual");if(!e)throw Error("No se encontr\xf3 ID de usuario");let s=await fetch(`/api/dashboard?id_usuario=${e}`);if(!s.ok){let e=await s.json();throw Error(e.error||"Error al cargar datos")}let r=await s.json(),t={...r,saldo_actual:Number(r.saldo_actual)||0,ingresos_mes:Number(r.ingresos_mes)||0,gastos_mes:Number(r.gastos_mes)||0};a(t)}catch(e){console.error("Error cargando dashboard:",e),a({saldo_actual:0,ingresos_mes:0,gastos_mes:0,proximas_cuotas:[],gastos_por_categoria:[],prediccion_proximo_mes:[]})}finally{o(!1)}};return s?r.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:r.jsx("div",{className:"spinner-border text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,r.jsxs)("div",{className:"d-flex",children:[r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"flex-grow-1",children:[r.jsx(i.Z,{}),(0,r.jsxs)("main",{className:"container-fluid py-4",children:[r.jsx("div",{className:"row mb-4",children:(0,r.jsxs)("div",{className:"col-12",children:[r.jsx("h1",{className:"h3 mb-0",children:"Dashboard"}),r.jsx("p",{className:"text-muted",children:"Resumen de tu situaci\xf3n financiera"})]})}),r.jsx(DashboardCards,{data:e}),(0,r.jsxs)("div",{className:"row mt-4",children:[r.jsx("div",{className:"col-lg-6 mb-4",children:(0,r.jsxs)("div",{className:"card h-100",children:[r.jsx("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[r.jsx("i",{className:"fas fa-chart-pie me-2"}),"Gastos por Categor\xeda (\xdaltimos 6 meses)"]})}),r.jsx("div",{className:"card-body",children:r.jsx(CategoryChart,{data:e?.gastos_por_categoria||[]})})]})}),r.jsx("div",{className:"col-lg-6 mb-4",children:(0,r.jsxs)("div",{className:"card h-100",children:[r.jsx("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[r.jsx("i",{className:"fas fa-chart-line me-2"}),"Predicci\xf3n Pr\xf3ximo Mes"]})}),r.jsx("div",{className:"card-body",children:r.jsx(PredictionChart,{data:e?.prediccion_proximo_mes||[]})})]})})]}),r.jsx("div",{className:"row mt-4",children:r.jsx("div",{className:"col-12",children:(0,r.jsxs)("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[r.jsx("i",{className:"fas fa-calendar-alt me-2"}),"Pr\xf3ximas Cuotas a Vencer"]})}),r.jsx("div",{className:"card-body",children:e?.proximas_cuotas?.length>0?r.jsx("div",{className:"table-responsive",children:(0,r.jsxs)("table",{className:"table table-hover",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Descripci\xf3n"}),r.jsx("th",{children:"Cuota"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Estado"})]})}),r.jsx("tbody",{children:e.proximas_cuotas.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:e.descripcion_gasto}),(0,r.jsxs)("td",{children:[e.nro_cuota,"/",e.total_cuotas]}),r.jsx("td",{children:new Date(e.fecha_vencimiento_cuota).toLocaleDateString()}),r.jsx("td",{children:r.jsx("span",{className:`badge ${"Pagada"===e.estado?"bg-success":"bg-warning"}`,children:e.estado})})]},e.id_cuota))})]})}):r.jsx("p",{className:"text-muted text-center py-3",children:"No hay cuotas pendientes pr\xf3ximas a vencer."})})]})})})]}),r.jsx(n.Z,{})]})]})}},1618:(e,a,s)=>{"use strict";s.r(a),s.d(a,{$$typeof:()=>c,__esModule:()=>i,default:()=>l});var r=s(5153);let t=(0,r.createProxy)(String.raw`C:\Users\User\Documents\PROYECTOS\BASE DE DATOS - Facultad\ProbandoReact\ControlaMas\app\dashboard\page.tsx`),{__esModule:i,$$typeof:c}=t,o=t.default,l=o}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),s=a.X(0,[862,879,232,718,655],()=>__webpack_exec__(1903));module.exports=s})();