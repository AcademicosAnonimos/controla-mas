(()=>{var e={};e.id=45,e.ids=[45],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},7092:(e,a,o)=>{"use strict";o.r(a),o.d(a,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>n,routeModule:()=>g,tree:()=>c});var s=o(7096),t=o(6132),r=o(7284),i=o.n(r),d=o(2564),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);o.d(a,l);let c=["",{children:["medio-pago",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(o.bind(o,3187)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\medio-pago\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(o.bind(o,5345)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(o.t.bind(o,9291,23)),"next/dist/client/components/not-found-error"]}],n=["C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\medio-pago\\page.tsx"],m="/medio-pago/page",p={require:o,loadChunk:()=>Promise.resolve()},g=new s.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/medio-pago/page",pathname:"/medio-pago",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3407:(e,a,o)=>{Promise.resolve().then(o.bind(o,6432))},6432:(e,a,o)=>{"use strict";o.r(a),o.d(a,{default:()=>MedioPagoPage});var s=o(784),t=o(9885),r=o(7100),i=o(7394);function MedioPagoForm({medioPago:e,onSuccess:a,onCancel:o}){let[r,i]=(0,t.useState)({medio_pago:""}),[d,l]=(0,t.useState)(!1),[c,n]=(0,t.useState)({}),[m,p]=(0,t.useState)([]);(0,t.useEffect)(()=>{cargarMediosExistentes(),e&&i(e)},[e]);let cargarMediosExistentes=async()=>{try{let e=await fetch("/api/medio-pago"),a=await e.json();p(a.map(e=>e.medio_pago.toLowerCase()))}catch(e){console.error("Error cargando medios existentes:",e)}},validateForm=()=>{let a={};if(r.medio_pago.trim()){let o=r.medio_pago.trim().toLowerCase();m.includes(o)&&!e&&(a.medio_pago="Ya existe un medio de pago con ese nombre")}else a.medio_pago="El nombre del medio de pago es requerido";return n(a),0===Object.keys(a).length},handleSubmit=async o=>{if(o.preventDefault(),validateForm()){l(!0);try{let o=e?`/api/medio-pago/${e.id_medio_pago}`:"/api/medio-pago",s=e?"PUT":"POST",t=await fetch(o,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({medio_pago:r.medio_pago.trim()})});if(t.ok)a(),alert(e?"Medio de pago actualizado correctamente":"Medio de pago creado correctamente");else{let e=await t.json();console.error("Error del servidor:",e),alert(e.error||"Error al guardar medio de pago")}}catch(e){console.error("Error en la solicitud:",e),alert("Error de conexi\xf3n al guardar medio de pago")}finally{l(!1)}}},getMedioColor=e=>{let a=e.toLowerCase().trim();return({efectivo:"#28a745",transferencia:"#17a2b8",credito:"#ffc107",debito:"#20c997",mercadopago:"#009ee3",paypal:"#003087",bitcoin:"#f7931a",débito:"#20c997",crédito:"#ffc107"})[a]||"#6c757d"};return(0,s.jsxs)("form",{onSubmit:handleSubmit,children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-12 mb-3",children:[(0,s.jsxs)("label",{htmlFor:"medio_pago",className:"form-label",children:["Nombre del Medio de Pago ",s.jsx("span",{className:"text-danger",children:"*"})]}),s.jsx("input",{type:"text",className:`form-control ${c.medio_pago?"is-invalid":""}`,id:"medio_pago",name:"medio_pago",value:r.medio_pago,onChange:e=>{let{name:a,value:o}=e.target;i(e=>({...e,[a]:o})),c.medio_pago&&n({})},placeholder:"Ej: Tarjeta de Cr\xe9dito, PayPal, Bitcoin, etc.",required:!0,disabled:d}),c.medio_pago&&s.jsx("div",{className:"invalid-feedback",children:c.medio_pago}),s.jsx("div",{className:"form-text",children:"Sugerencias: Efectivo, Transferencia, D\xe9bito, Cr\xe9dito, MercadoPago, PayPal, Bitcoin"}),m.length>0&&(0,s.jsxs)("div",{className:"form-text",children:["Medios existentes: ",m.join(", ")]})]}),r.medio_pago&&(0,s.jsxs)("div",{className:"col-12 mb-3",children:[s.jsx("label",{className:"form-label",children:"Vista Previa:"}),s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"card-body text-center",children:[s.jsx("i",{className:`${(e=>{let a=e.toLowerCase().trim();return({efectivo:"fas fa-money-bill-wave",transferencia:"fas fa-exchange-alt",credito:"fas fa-credit-card",debito:"fas fa-credit-card",mercadopago:"fas fa-mobile-alt",paypal:"fab fa-paypal",bitcoin:"fab fa-bitcoin",débito:"fas fa-credit-card",crédito:"fas fa-credit-card"})[a]||"fas fa-wallet"})(r.medio_pago)} fa-2x mb-2`,style:{color:getMedioColor(r.medio_pago)}}),s.jsx("h6",{className:"card-title text-capitalize mb-0",children:s.jsx("span",{className:"badge",style:{backgroundColor:getMedioColor(r.medio_pago),color:(e=>{let a=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return(.299*a+.587*o+.114*s)/255>.5?"#000000":"#ffffff"})(getMedioColor(r.medio_pago))},children:r.medio_pago})}),s.jsx("small",{className:"text-muted",children:"El color se asignar\xe1 autom\xe1ticamente seg\xfan el nombre"})]})})]})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:o,disabled:d,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?(0,s.jsxs)(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Guardando..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("i",{className:"fas fa-save me-2"}),e?"Actualizar":"Crear"," Medio de Pago"]})})]})]})}var d=o(4911);function MedioPagoPage(){let[e,a]=(0,t.useState)([]),[o,l]=(0,t.useState)(!1),[c,n]=(0,t.useState)(null),[m,p]=(0,t.useState)(!0);(0,t.useEffect)(()=>{cargarMediosPago()},[]);let cargarMediosPago=async()=>{try{let e=await fetch("/api/medio-pago"),o=await e.json();a(o)}catch(e){console.error("Error cargando medios de pago:",e)}finally{p(!1)}},handleEdit=e=>{n(e),l(!0)},handleDelete=async e=>{if(confirm("\xbfEst\xe1s seguro de eliminar este medio de pago?"))try{let a=await fetch(`/api/medio-pago/${e}`,{method:"DELETE"});if(a.ok)cargarMediosPago(),alert("Medio de pago eliminado correctamente");else{let e=await a.json();alert(e.error)}}catch(e){alert("Error al eliminar medio de pago")}},getMedioColor=e=>{let a=e.toLowerCase().trim();return({efectivo:"#28a745",transferencia:"#17a2b8",credito:"#ffc107",debito:"#20c997",mercadopago:"#009ee3",paypal:"#003087",bitcoin:"#f7931a",débito:"#20c997",crédito:"#ffc107"})[a]||"#6c757d"},getMedioIcon=e=>{let a=e.toLowerCase().trim();return({efectivo:"fas fa-money-bill-wave",transferencia:"fas fa-exchange-alt",credito:"fas fa-credit-card",debito:"fas fa-credit-card",mercadopago:"fas fa-mobile-alt",paypal:"fab fa-paypal",bitcoin:"fab fa-bitcoin",débito:"fas fa-credit-card",crédito:"fas fa-credit-card"})[a]||"fas fa-wallet"},getContrastColor=e=>{let a=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return(.299*a+.587*o+.114*s)/255>.5?"#000000":"#ffffff"};return(0,s.jsxs)("div",{className:"d-flex",children:[s.jsx(i.Z,{}),(0,s.jsxs)("div",{className:"flex-grow-1",children:[s.jsx(r.Z,{}),(0,s.jsxs)("main",{className:"container-fluid py-4",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"h3 mb-0",children:"Medios de Pago"}),s.jsx("p",{className:"text-muted",children:"Gestiona los medios de pago disponibles"})]}),(0,s.jsxs)("button",{className:"btn btn-primary",onClick:()=>l(!0),children:[s.jsx("i",{className:"fas fa-plus me-2"}),"Nuevo Medio de Pago"]})]}),s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"card-body",children:[m?s.jsx("div",{className:"text-center py-4",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):s.jsx("div",{className:"row",children:e.map(e=>{let a=getMedioColor(e.medio_pago),o=getContrastColor(a);return s.jsx("div",{className:"col-md-6 col-lg-4 mb-3",children:s.jsx("div",{className:"card card-hover h-100",children:(0,s.jsxs)("div",{className:"card-body text-center",children:[s.jsx("i",{className:`${getMedioIcon(e.medio_pago)} fa-3x mb-3`,style:{color:a}}),s.jsx("h5",{className:"card-title text-capitalize mb-2",children:e.medio_pago}),s.jsx("div",{className:"mb-3",children:s.jsx("span",{className:"badge",style:{backgroundColor:a,color:o},children:e.medio_pago})}),(0,s.jsxs)("p",{className:"card-text text-muted small",children:["credito"===e.medio_pago.toLowerCase()&&"Pagos con tarjeta de cr\xe9dito (impacto diferido)","debito"===e.medio_pago.toLowerCase()&&"Pagos con tarjeta de d\xe9bito","efectivo"===e.medio_pago.toLowerCase()&&"Pagos en efectivo","transferencia"===e.medio_pago.toLowerCase()&&"Transferencias bancarias","mercadopago"===e.medio_pago.toLowerCase()&&"Pagos mediante Mercado Pago",!["credito","debito","efectivo","transferencia","mercadopago"].includes(e.medio_pago.toLowerCase())&&"Medio de pago personalizado"]}),(0,s.jsxs)("div",{className:"mt-auto",children:[(0,s.jsxs)("small",{className:"text-muted d-block mb-2",children:["ID: ",e.id_medio_pago]}),(0,s.jsxs)("div",{className:"btn-group btn-group-sm",children:[s.jsx("button",{className:"btn btn-outline-primary",onClick:()=>handleEdit(e),children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{className:"btn btn-outline-danger",onClick:()=>handleDelete(e.id_medio_pago),children:s.jsx("i",{className:"fas fa-trash"})})]})]})]})})},e.id_medio_pago)})}),0===e.length&&!m&&(0,s.jsxs)("div",{className:"text-center py-5 text-muted",children:[s.jsx("i",{className:"fas fa-credit-card fa-3x mb-3"}),s.jsx("p",{children:"No hay medios de pago registrados"}),(0,s.jsxs)("button",{className:"btn btn-primary",onClick:()=>l(!0),children:[s.jsx("i",{className:"fas fa-plus me-2"}),"Crear Primer Medio de Pago"]})]})]})}),o&&s.jsx("div",{className:"modal fade show d-block",tabIndex:-1,children:s.jsx("div",{className:"modal-dialog modal-lg",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title",children:c?"Editar Medio de Pago":"Nuevo Medio de Pago"}),s.jsx("button",{type:"button",className:"btn-close",onClick:()=>l(!1)})]}),s.jsx("div",{className:"modal-body",children:s.jsx(MedioPagoForm,{medioPago:c,onSuccess:()=>{l(!1),n(null),cargarMediosPago()},onCancel:()=>l(!1)})})]})})})]}),s.jsx(d.Z,{})]})]})}},3187:(e,a,o)=>{"use strict";o.r(a),o.d(a,{$$typeof:()=>i,__esModule:()=>r,default:()=>l});var s=o(5153);let t=(0,s.createProxy)(String.raw`C:\Users\User\Documents\PROYECTOS\BASE DE DATOS - Facultad\ProbandoReact\ControlaMas\app\medio-pago\page.tsx`),{__esModule:r,$$typeof:i}=t,d=t.default,l=d}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),o=a.X(0,[862,879,718,655],()=>__webpack_exec__(7092));module.exports=o})();