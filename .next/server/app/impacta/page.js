(()=>{var e={};e.id=82,e.ids=[82],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},3244:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>c.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>o});var r=s(7096),t=s(6132),l=s(7284),c=s.n(l),n=s(2564),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);s.d(a,i);let o=["",{children:["impacta",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1306)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\impacta\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\impacta\\page.tsx"],m="/impacta/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/impacta/page",pathname:"/impacta",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8471:(e,a,s)=>{Promise.resolve().then(s.bind(s,8364))},8364:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>ImpactaPage});var r=s(784),t=s(9885),l=s(7100),c=s(7394),n=s(4911);function ImpactaPage(){let[e,a]=(0,t.useState)([]),[s,i]=(0,t.useState)(!0),[o,d]=(0,t.useState)(""),[m,x]=(0,t.useState)("");(0,t.useEffect)(()=>{cargarImpactos()},[]);let cargarImpactos=async()=>{try{let e=localStorage.getItem("usuarioActual"),s=await fetch(`/api/impacta?id_usuario=${e}`),r=await s.json();a(r)}catch(e){console.error("Error cargando impactos:",e)}finally{i(!1)}},formatCurrency=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),formatDate=e=>new Date(e).toLocaleDateString("es-AR"),getNombreMes=e=>new Date(2e3,e-1).toLocaleString("es-AR",{month:"long"}),p=e.filter(e=>{let a=!o||e.mes===parseInt(o),s=!m||e.año===parseInt(m);return a&&s}),h=Array.from(new Set(e.map(e=>e.año))).sort((e,a)=>a-e),u=Array.from(new Set(e.map(e=>e.mes))).sort((e,a)=>e-a),j=(()=>{let e={};return p.forEach(a=>{let s=`${a.mes}/${a.año}`;e[s]=(e[s]||0)+a.importe_a_pagar}),e})();return(0,r.jsxs)("div",{className:"d-flex",children:[r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"flex-grow-1",children:[r.jsx(l.Z,{}),(0,r.jsxs)("main",{className:"container-fluid py-4",children:[r.jsx("div",{className:"d-flex justify-content-between align-items-center mb-4",children:(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"h3 mb-0",children:"Impacto de Pagos"}),r.jsx("p",{className:"text-muted",children:"Pagos que impactan en meses diferentes al original"})]})}),r.jsx("div",{className:"card mb-4",children:r.jsx("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"col-md-4",children:[r.jsx("label",{htmlFor:"filtroMes",className:"form-label",children:"Filtrar por Mes"}),(0,r.jsxs)("select",{id:"filtroMes",className:"form-select",value:o,onChange:e=>d(e.target.value),children:[r.jsx("option",{value:"",children:"Todos los meses"}),u.map(e=>r.jsx("option",{value:e,children:getNombreMes(e)},e))]})]}),(0,r.jsxs)("div",{className:"col-md-4",children:[r.jsx("label",{htmlFor:"filtroA\xf1o",className:"form-label",children:"Filtrar por A\xf1o"}),(0,r.jsxs)("select",{id:"filtroA\xf1o",className:"form-select",value:m,onChange:e=>x(e.target.value),children:[r.jsx("option",{value:"",children:"Todos los a\xf1os"}),h.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),r.jsx("div",{className:"col-md-4 d-flex align-items-end",children:(0,r.jsxs)("button",{className:"btn btn-outline-secondary w-100",onClick:()=>{d(""),x("")},children:[r.jsx("i",{className:"fas fa-times me-2"}),"Limpiar Filtros"]})})]})})}),Object.keys(j).length>0&&(0,r.jsxs)("div",{className:"card mb-4",children:[r.jsx("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[r.jsx("i",{className:"fas fa-chart-bar me-2"}),"Resumen por Mes de Impacto"]})}),r.jsx("div",{className:"card-body",children:r.jsx("div",{className:"row",children:Object.entries(j).map(([e,a])=>{let[s,t]=e.split("/");return r.jsx("div",{className:"col-md-3 col-sm-6 mb-3",children:r.jsx("div",{className:"card bg-light",children:(0,r.jsxs)("div",{className:"card-body text-center p-3",children:[(0,r.jsxs)("h6",{className:"card-title mb-1",children:[getNombreMes(parseInt(s))," ",t]}),r.jsx("p",{className:"card-text h5 text-danger mb-0",children:formatCurrency(a)}),r.jsx("small",{className:"text-muted",children:"Total impactado"})]})})},e)})})})]}),r.jsx("div",{className:"card",children:r.jsx("div",{className:"card-body",children:s?r.jsx("div",{className:"text-center py-4",children:r.jsx("div",{className:"spinner-border text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"table-responsive",children:(0,r.jsxs)("table",{className:"table table-hover",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Gasto"}),r.jsx("th",{children:"Medio de Pago"}),r.jsx("th",{children:"Fecha Pago Real"}),r.jsx("th",{children:"Mes/A\xf1o Impacto"}),r.jsx("th",{children:"Importe"}),r.jsx("th",{children:"Usuario"})]})}),r.jsx("tbody",{children:p.map((e,a)=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:r.jsx("div",{children:r.jsx("strong",{children:e.descripcion_gasto})})}),r.jsx("td",{children:(0,r.jsxs)("span",{className:"badge bg-info",children:[r.jsx("i",{className:"fas fa-credit-card me-1"}),e.medio_pago]})}),r.jsx("td",{children:formatDate(e.fecha_pago)}),r.jsx("td",{children:(0,r.jsxs)("span",{className:"badge bg-warning",children:[getNombreMes(e.mes)," ",e.año]})}),r.jsx("td",{className:"text-danger fw-bold",children:formatCurrency(e.importe_a_pagar)}),r.jsx("td",{children:e.usuario_nombre})]},`${e.id_pago}-${e.id_medio_pago}-${e.mes}-${e.año}-${a}`))})]})}),0===p.length&&(0,r.jsxs)("div",{className:"text-center py-5 text-muted",children:[r.jsx("i",{className:"fas fa-calendar-alt fa-3x mb-3"}),r.jsx("p",{children:0===e.length?"No hay pagos con impacto diferido registrados":"No hay resultados para los filtros aplicados"}),0===e.length&&r.jsx("small",{children:"Los pagos con tarjeta de cr\xe9dito aparecer\xe1n aqu\xed cuando tengan impacto en meses diferentes"})]})]})})})]}),r.jsx(n.Z,{})]})]})}},1306:(e,a,s)=>{"use strict";s.r(a),s.d(a,{$$typeof:()=>c,__esModule:()=>l,default:()=>i});var r=s(5153);let t=(0,r.createProxy)(String.raw`C:\Users\User\Documents\PROYECTOS\BASE DE DATOS - Facultad\ProbandoReact\ControlaMas\app\impacta\page.tsx`),{__esModule:l,$$typeof:c}=t,n=t.default,i=n}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),s=a.X(0,[862,879,866,655],()=>__webpack_exec__(3244));module.exports=s})();