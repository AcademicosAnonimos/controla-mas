(()=>{var e={};e.id=727,e.ids=[727],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},7439:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>o});var r=a(7096),i=a(6132),t=a(7284),l=a.n(t),c=a(2564),n={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>c[e]);a.d(s,n);let o=["",{children:["historial-prediccion",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1345)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\historial-prediccion\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,5345)),"C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\User\\Documents\\PROYECTOS\\BASE DE DATOS - Facultad\\ProbandoReact\\ControlaMas\\app\\historial-prediccion\\page.tsx"],m="/historial-prediccion/page",x={require:a,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/historial-prediccion/page",pathname:"/historial-prediccion",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9314:(e,s,a)=>{Promise.resolve().then(a.bind(a,9303))},9303:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>HistorialPrediccionPage});var r=a(784),i=a(9885),t=a(7100),l=a(7394),c=a(4911);function HistorialPrediccionPage(){let[e,s]=(0,i.useState)([]),[a,n]=(0,i.useState)(!0),[o,d]=(0,i.useState)(""),[m,x]=(0,i.useState)("");(0,i.useEffect)(()=>{cargarHistorial()},[o,m]);let cargarHistorial=async()=>{try{let e=localStorage.getItem("usuarioActual"),a=`/api/historial-prediccion?id_usuario=${e}`;o&&(a+=`&mes=${o}`),m&&(a+=`&a\xf1o=${m}`);let r=await fetch(a),i=await r.json();s(i)}catch(e){console.error("Error cargando historial de predicci\xf3n:",e)}finally{n(!1)}},parseMontoPredicho=e=>{if(!e)return 0;let s=parseFloat(e);return isNaN(s)?0:s},formatCurrency=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),h=Array.from(new Set(e.map(e=>e.año))).sort((e,s)=>s-e),u=Array.from(new Set(e.map(e=>e.mes))).sort((e,s)=>e-s),p=e.reduce((e,s)=>{let a=`${s.año}-${s.mes}`;e[a]||(e[a]={año:s.año,mes:s.mes,nombre_mes:s.nombre_mes,total_predicho:0,categorias:[]});let r=parseMontoPredicho(s.monto_predicho);return e[a].total_predicho+=r,e[a].categorias.push(s),e},{}),j=Object.values(p).sort((e,s)=>e.año!==s.año?s.año-e.año:s.mes-e.mes);return(0,r.jsxs)("div",{className:"d-flex",children:[r.jsx(l.Z,{}),(0,r.jsxs)("div",{className:"flex-grow-1",children:[r.jsx(t.Z,{}),(0,r.jsxs)("main",{className:"container-fluid py-4",children:[r.jsx("div",{className:"d-flex justify-content-between align-items-center mb-4",children:(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"h3 mb-0",children:"Historial de Predicciones"}),r.jsx("p",{className:"text-muted",children:"An\xe1lisis de tendencias de gastos por categor\xeda"})]})}),r.jsx("div",{className:"card bg-light border-0 mb-4",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsxs)("h5",{className:"card-title",children:[r.jsx("i",{className:"fas fa-chart-line text-primary me-2"}),"\xbfQu\xe9 es el Historial de Predicciones?"]}),(0,r.jsxs)("p",{className:"card-text",children:["Esta secci\xf3n muestra ",r.jsx("strong",{children:"patrones hist\xf3ricos de tus gastos"})," organizados por categor\xeda. El sistema analiza autom\xe1ticamente tus gastos pasados para predecir tendencias futuras."]}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"col-md-6",children:[r.jsx("h6",{className:"text-primary",children:"\uD83D\uDCCA \xbfQu\xe9 informaci\xf3n encuentras aqu\xed?"}),(0,r.jsxs)("ul",{className:"small",children:[(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Montos predichos"})," por categor\xeda y mes"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Tendencias de gasto"})," a lo largo del tiempo"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Patrones estacionales"})," en tus finanzas"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Base para predicciones"})," del pr\xf3ximo mes"]})]})]}),(0,r.jsxs)("div",{className:"col-md-6",children:[r.jsx("h6",{className:"text-success",children:"\uD83C\uDFAF \xbfC\xf3mo usar esta informaci\xf3n?"}),(0,r.jsxs)("ul",{className:"small",children:[(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Planifica tu presupuesto"})," mensual"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Anticipa gastos"})," recurrentes"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Identifica categor\xedas"})," con mayor variaci\xf3n"]}),(0,r.jsxs)("li",{children:[r.jsx("strong",{children:"Mejora tu control"})," financiero"]})]})]})]}),r.jsx("div",{className:"alert alert-info mt-3 mb-0",children:(0,r.jsxs)("small",{children:[r.jsx("i",{className:"fas fa-info-circle me-2"}),r.jsx("strong",{children:"Nota:"})," Los datos se actualizan autom\xe1ticamente cada vez que registras un pago. El sistema utiliza un promedio m\xf3vil de los \xfaltimos 6 meses para las predicciones."]})})]})}),r.jsx("div",{className:"card mb-4",children:r.jsx("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"col-md-4",children:[r.jsx("label",{htmlFor:"filtroMes",className:"form-label",children:"Filtrar por Mes"}),(0,r.jsxs)("select",{id:"filtroMes",className:"form-select",value:o,onChange:e=>d(e.target.value),children:[r.jsx("option",{value:"",children:"Todos los meses"}),u.map(e=>r.jsx("option",{value:e,children:new Date(2e3,e-1).toLocaleString("es-AR",{month:"long"})},e))]})]}),(0,r.jsxs)("div",{className:"col-md-4",children:[r.jsx("label",{htmlFor:"filtroA\xf1o",className:"form-label",children:"Filtrar por A\xf1o"}),(0,r.jsxs)("select",{id:"filtroA\xf1o",className:"form-select",value:m,onChange:e=>x(e.target.value),children:[r.jsx("option",{value:"",children:"Todos los a\xf1os"}),h.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),r.jsx("div",{className:"col-md-4 d-flex align-items-end",children:(0,r.jsxs)("button",{className:"btn btn-outline-secondary w-100",onClick:()=>{d(""),x("")},children:[r.jsx("i",{className:"fas fa-times me-2"}),"Limpiar Filtros"]})})]})})}),j.length>0&&(0,r.jsxs)("div",{className:"card mb-4",children:[r.jsx("div",{className:"card-header",children:(0,r.jsxs)("h5",{className:"card-title mb-0",children:[r.jsx("i",{className:"fas fa-chart-bar me-2"}),"Resumen Mensual de Predicciones"]})}),r.jsx("div",{className:"card-body",children:r.jsx("div",{className:"row",children:j.slice(0,6).map(e=>r.jsx("div",{className:"col-md-4 col-lg-2 mb-3",children:r.jsx("div",{className:"card bg-primary text-white text-center",children:(0,r.jsxs)("div",{className:"card-body p-3",children:[(0,r.jsxs)("h6",{className:"card-title mb-1 small",children:[e.nombre_mes.trim()," ",e.año]}),r.jsx("p",{className:"card-text h6 mb-0",children:formatCurrency(e.total_predicho)}),(0,r.jsxs)("small",{className:"opacity-75",children:[e.categorias.length," categor\xedas"]})]})})},`${e.año}-${e.mes}`))})})]}),r.jsx("div",{className:"card",children:r.jsx("div",{className:"card-body",children:a?r.jsx("div",{className:"text-center py-4",children:r.jsx("div",{className:"spinner-border text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"table-responsive",children:(0,r.jsxs)("table",{className:"table table-hover",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Mes/A\xf1o"}),r.jsx("th",{children:"Categor\xeda"}),r.jsx("th",{children:"Monto Predicho"}),r.jsx("th",{children:"Variaci\xf3n"})]})}),r.jsx("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[r.jsx("td",{children:(0,r.jsxs)("strong",{children:[e.nombre_mes.trim()," ",e.año]})}),r.jsx("td",{children:r.jsx("span",{className:"badge bg-info text-capitalize",children:e.categoria})}),r.jsx("td",{className:"fw-bold text-primary",children:formatCurrency(parseMontoPredicho(e.monto_predicho))}),r.jsx("td",{children:(0,r.jsxs)("span",{className:"badge bg-success",children:[r.jsx("i",{className:"fas fa-chart-line me-1"}),"Tendencia"]})})]},e.id_historial))})]})}),0===e.length&&(0,r.jsxs)("div",{className:"text-center py-5 text-muted",children:[r.jsx("i",{className:"fas fa-chart-line fa-3x mb-3"}),r.jsx("p",{children:o||m?"No hay datos de predicci\xf3n para los filtros aplicados":"No hay historial de predicciones disponible"}),r.jsx("small",{children:"El historial se generar\xe1 autom\xe1ticamente a medida que registres pagos en el sistema."})]})]})})})]}),r.jsx(c.Z,{})]})]})}},1345:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>l,__esModule:()=>t,default:()=>n});var r=a(5153);let i=(0,r.createProxy)(String.raw`C:\Users\User\Documents\PROYECTOS\BASE DE DATOS - Facultad\ProbandoReact\ControlaMas\app\historial-prediccion\page.tsx`),{__esModule:t,$$typeof:l}=i,c=i.default,n=c}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[862,879,866,655],()=>__webpack_exec__(7439));module.exports=a})();